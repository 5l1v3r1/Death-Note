function module_info {
if [ "$language" = "VN" ]; then
cat << !

        Tên: Từ chối dịch vụ CVE-2019-0708 RDP
     Mô-đun: exploit/windows/rdp/CVE-2019-0708_rdp_dos
   Nền tảng: Windows
    Công bố: 14/05/2019

Cung cấp bởi:
  @Ekultek

Mục tiêu khả dụng:
   Id  Tên
   --  ----
   0   win x64
   1   win x86
!
module_compare
cat << !
Miêu tả:


Tham khảo:

Còn được biết là:
   BlueKeep

!
elif [ "$language" = "EN" ]; then
cat << !

       Name: Denial Of Service CVE-2019-0708 RDP
     Module: exploit/windows/rdp/CVE-2019-0708_rdp_dos
   Platform: Windows
  Disclosed: 14/05/2019

Provided by:
  @Ekultek

Available targets:
   Id  Name
   --  ----
   0   win x64
   1   win x86
!
module_compare
cat << !
Description:

References:

Also known as:
  BlueKeep


!
fi

}
############ Hàm gán giá trị các biến #####################
function defaul_module_options {
	rhost=""
	rport="3389"
	num_channel="1"
	num_dos="0"
	target="0"
	rhost_lenght=18
}
############# Hàm kiểm tra chọn lựa để in ra màng hình ###############
function module_compare {
i_characters="i"
g_characters="g"	
_characters1="-"
_characters2="-"
if [[ $rhost_lenght -le 18 ]]; then
	rhost_lenght=18
fi
if  [[ "$rhost_lenght" -le 18 ]]; then
		module1
else
		module2
fi
}
############### Hàm nhận giá trị nhận vào của biến ###################
function set_module {
		if [[ "$new_processing_variables" = "rhost" ]] || [[ "$new_processing_variables" = "RHOST" ]] || [[ "$new_processing_variables" = "Rhost" ]]; then
			unset rhost
			rhost="$module_set"
			rhost_lenght=`echo $rhost | awk '{print length}'`
			if [[ $rhost_lenght -le 18 ]]; then
				rhost_lenght=18
			fi
		elif [[ "$new_processing_variables" = "rport" ]] || [[ "$new_processing_variables" = "RPORT" ]] || [[ "$new_processing_variables" = "Rport" ]]; then
			unset rport
			rport="$module_set"
		elif [[ "$new_processing_variables" = "num_channel" ]] || [[ "$new_processing_variables" = "NUM_CHANNEL" ]] || [[ "$new_processing_variables" = "Num_channel" ]]; then
			unset num_channel
			num_channel="$module_set"
		elif [[ "$new_processing_variables" = "num_dos" ]] || [[ "$new_processing_variables" = "num_dos" ]] || [[ "$new_processing_variables" = "num_dos" ]]; then
			unset num_dos
			num_dos="$module_set"
		elif [[ "$new_processing_variables" = "target" ]] || [[ "$new_processing_variables" = "TARGET" ]] || [[ "$new_processing_variables" = "Target" ]]; then
			if [[ "$module_set" = "0" ]]; then
				unset target
				target="$module_set"
			elif [[ "$module_set" = "1" ]]; then
				unset target
				target="$module_set"
			else 	failed_to_validate=" $failed_validate'$module_set' $notvalid '$new_processing_variables'"
				echo -e "$red[-]$RESET" $failed_to_validate
			fi
		fi
}

##################### Hàm canh lề cho biến ###################
############# Khi các biến có độ dài nhỏ hơn 18 ###############
function module1 {
none=" "
myvar=""
	function unset_value {
		unset none
		unset myvar
		unset integer
		none=" "
		myvar=""
	}
rhost=`echo $rhost`
rhost_lenght=`echo $rhost | awk '{print length}'`
	integer=`expr 20 - $rhost_lenght`			
	for (( i = 0 ; i < $integer; i++ )) do
		myvar=$myvar$none
	done
	rhost=$rhost$myvar
unset_value
rport=`echo $rport`
rport_lenght=`echo $rport | awk '{print length}'`
	integer=`expr 20 - $rport_lenght`			
	for (( i = 0 ; i < $integer; i++ )) do
		myvar=$myvar$none
	done
	rport=$rport$myvar
unset_value
num_channel=`echo $num_channel`
num_channel_lenght=`echo $num_channel | awk '{print length}'`
	integer=`expr 20 - $num_channel_lenght`			
	for (( i = 0 ; i < $integer; i++ )) do
	myvar=$myvar$none
	done
	num_channel=$num_channel$myvar
unset_value
num_dos=`echo $num_dos`
num_dos_lenght=`echo $num_dos | awk '{print length}'`
	integer=`expr 20 - $num_dos_lenght`			
	for (( i = 0 ; i < $integer; i++ )) do
	myvar=$myvar$none
	done
	num_dos=$num_dos$myvar
unset_value
module_banner_1
}
function module2 {
none=" "
myvar=""
	function unset_value {
		unset none
		unset myvar
		unset subtract_compare_value
		none=" "
		myvar=""
	}
rhost=`echo $rhost`
rhost_lenght=`echo $rhost | awk '{print length}'`
greater_value=$rhost_lenght
rport=`echo $rport`
rport_lenght=`echo $rport | awk '{print length}'`
subtract_compare_value=`expr $greater_value - $rport_lenght + 3`	
	for (( i = 0 ; i < $subtract_compare_value; i++ )) do
		myvar=$myvar$none
	done
	rport=$rport$myvar
unset_value
num_channel=`echo $num_channel`
num_channel_lenght=`echo $num_channel | awk '{print length}'`
subtract_compare_value=`expr $greater_value - $num_channel_lenght + 3`	
	for (( i = 0 ; i < $subtract_compare_value; i++ )) do
		myvar=$myvar$none
	done
	num_channel=$num_channel$myvar
unset_value
num_dos=`echo $num_dos`
num_dos_lenght=`echo $num_dos | awk '{print length}'`
subtract_compare_value=`expr $greater_value - $num_dos_lenght + 3`	
	for (( i = 0 ; i < $subtract_compare_value; i++ )) do
		myvar=$myvar$none
	done
	num_dos=$num_dos$myvar
unset_value
subtract_compare_value=`expr $greater_value - 17 + 4`
for (( i = 0 ; i < $subtract_compare_value; i++ )) do
		myvar=$myvar$none
	done
	i_characters=$i_characters$myvar
unset_value
subtract_compare_value=`expr $greater_value - 17 + 4`
for (( i = 0 ; i < $subtract_compare_value; i++ )) do
		myvar=$myvar$none
	done
	g_characters=$g_characters$myvar
unset_value
subtract_compare_value=`expr $greater_value - 16 + 5`
for (( i = 0 ; i < $subtract_compare_value; i++ )) do
		myvar=$myvar$none
	done
	_characters1=$_characters1$myvar
unset_value
subtract_compare_value=`expr $greater_value - 16 + 3`
for (( i = 0 ; i < $subtract_compare_value; i++ )) do
		myvar=$myvar$none
	done
	_characters2=$_characters2$myvar
unset_value

module_banner_2
}
function module_banner_1 {
if [ "$language" = "VN" ]; then
yes="  Có"
no="  Không"
cat << !

Các tùy chọn của mô-đun (exploit/windows/rdp/CVE-2019-0708_rdp_dos):

   Tên       	  Thiết lập hiện tại 	Yêu cầu   Miêu tả
   ----           --------------- 	--------  -----------
   RHOST          $rhost $yes       Địa chỉ hoặc tên miền của máy chủ mục tiêu.
   RPORT          $rport $no	  Cổng dịch vụ máy chủ RDP đang chạy.
   NUM_DOS        $num_dos $no	  Số lần thực hiện tấn công trên máy chủ mục tiêu.
   NUM_CHANNEL    $num_channel $no	  Số kênh thực hiện tấn công trên máy chủ mục tiêu.
!
elif [ "$language" = "EN" ]; then
yes="  yes"
no="  no "
cat << !

Module options (exploit/windows/rdp/CVE-2019-0708_rdp_dos):

   Name           Current Setting 	Required  Description
   ----           --------------- 	--------  -----------
   RHOST          $rhost $yes      Address or domain name of target server.
   RPORT          $rport $no	  The Webmin server service port is running.
   NUM_DOS        $num_dos $no	  Number of attacks performed on the target server.
   NUM_CHANNEL    $num_channel $no	  Number of channels performing attacks on the target server.
!
fi	
}
function module_banner_2 {
if [ "$language" = "VN" ]; then
yes="  Có"
no="  Không"
cat << !

Các tùy chọn của mô-đun (exploit/windows/rdp/CVE-2019-0708_rdp_dos):

   Tên       	  Thiết lập hiện tạ${i_characters}Yêu cầu   Miêu tả
   ----       	  ---------------${_characters1}--------  -----------
   RHOST          $rhost $yes       Địa chỉ hoặc tên miền của máy chủ mục tiêu
   RPORT          $rport $no    Cổng dịch vụ máy chủ Webmin đang chạy.
   NUM_DOS        $num_dos $no	  Số lần thực hiện tấn công trên máy chủ mục tiêu.
   NUM_CHANNEL    $num_channel $no	  Số kênh thực hiện tấn công trên máy chủ mục tiêu.
!
elif [ "$language" = "EN" ]; then
yes="  yes"
no="  no "
cat << !

Module options (exploit/windows/rdp/CVE-2019-0708_rdp_dos):

   Name           Current Setting${g_characters}Required  Description
   ----           ---------------${_characters2}--------  -----------
   RHOST          $rhost $yes      Address or domain name of target server.
   NUM_DOS        $num_dos $no	  Number of attacks performed on the target server.
   NUM_CHANNEL    $num_channel $no	  Number of channels performing attacks on the target server.
!
fi
		
}
################# targets ###################
#############################################
function show_targets {
if [ "$language" = "VN" ]; then
cat << !
Các mục tiêu có thể khai thác:
   Id  Tên
   --  ----
   0   win x64
   1   win x86

!
elif [ "$language" = "EN" ]; then
cat << !
Exploit target:
   Id  Name
   --  ----
   0   win x64
   1   win x86

!
fi
}

function target {
if [ "$language" = "VN" ]; then
	if [ "$target" = "0" ]; then 
cat << !
Các mục tiêu có thể khai thác:
   Id  Tên
   --  ----
   0   win x64

!
else
cat << !
Các mục tiêu có thể khai thác:
   Id  Tên
   --  ----
   1   win x32

!
fi
elif [ "$language" = "EN" ]; then
	if [ "$target" = "0" ]; then 
cat << !
Exploit target:
   Id  Name
   --  ----
   0   win x64

!
	else
cat << !
Exploit target:
   Id  Name
   --  ----
   0   win x32

!
	fi
fi
}
################# payload list ###################
#############################################
function payload_list {
echo -n ""
}
function out_value {
rhost=`echo $rhost`
rport=`echo $rport`
num_channel=`echo $num_channel`
num_dos=`echo $num_dos`
}
function check {
echo -e "[${red}-${RESET}] $not_module_check"
}
function module_run {
echo -n ""
}
function attack {
#####################
path_present=`pwd`
###################
out_value
path_tool="../../Tools/Vulnerability-Exploit/CVE-2019-15107/"
cd $path_tool
echo -e "${BlueF}[*]$RESET $check_vuln http$s://$rhost:$rport"
check_host=`bash CVE-2019-15107_check.sh http$s://$rhost:$rport`
if [[ "$check_host" = "VULNERABLE" ]]; then
	echo -e "${yellow}[+]$RESET $found_vuln ${red}CVE-2019-15107${RESET}"
else
	echo -e "${red}[-]$RESET $not_vuln http$s://$rhost:$rport"
fi
cd $path_present
}


